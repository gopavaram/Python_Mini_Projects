# Write your MySQL query statement below
select s.student_id, s.student_name, b.subject_name, count(e.subject_name) as attended_exams
from Students s
cross join Subjects b
left join Examinations as e
on e.student_id = s.student_id
and b.subject_name = e.subject_name
group by s.student_id, s.student_name, b.subject_name
order by s.student_id, b.subject_name



# Write your MySQL query statement below
select e1.name
from Employee e1
join Employee e2
on e1.id=e2.managerId
group by e2.managerId
having count(e2.managerId)>=5


# Write your MySQL query statement below
SELECT s.user_id, ifnull(round(sum(c.action ='confirmed')/count(c.action),2), 0.00) AS confirmation_rate
#round(avg(if(c.action = 'confirmed' ,1,0)),2)
FROM Signups s
left Join Confirmations c
on s.user_id = c.user_id
GROUP BY s.user_id;


# Write your MySQL query statement below
select candidate_id from candidates
WHERE skill in ('Python', 'Tableau', 'PostgreSQL')
GROUP by candidate_id
HAVING count(skill) =3 ;

# Write your MySQL query statement below
SELECT p1.page_id
FROM pages p1
left JOIN page_likes p2
on p1.page_id = p2.page_id
Where p2.page_id is NULL
order by p1.page_id;

# Write your MySQL query statement below
select sum(case WHEN device_type = 'laptop' Then 1 else 0 END) as laptop_views,
sum(case when device_type IN('phone', 'tablet') then 1 else 0 END) as mobile_views
from viewership;

# Write your MySQL query statement below
SELECT user_id, MAX(post_date::DATE) - MIN(post_date::DATE) AS days_between
FROM posts
WHERE post_date BETWEEN '2021-01-01' AND '2021-12-31'
group by user_id
HAVING COUNT(user_id) > 2;
