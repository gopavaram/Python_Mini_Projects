# Write your MySQL query statement below
select s.student_id, s.student_name, b.subject_name, count(e.subject_name) as attended_exams
from Students s
cross join Subjects b
left join Examinations as e
on e.student_id = s.student_id
and b.subject_name = e.subject_name
group by s.student_id, s.student_name, b.subject_name
order by s.student_id, b.subject_name



# Write your MySQL query statement below
select e1.name
from Employee e1
join Employee e2
on e1.id=e2.managerId
group by e2.managerId
having count(e2.managerId)>=5


# Write your MySQL query statement below
SELECT s.user_id, ifnull(round(sum(c.action ='confirmed')/count(c.action),2), 0.00) AS confirmation_rate
#round(avg(if(c.action = 'confirmed' ,1,0)),2)
FROM Signups s
left Join Confirmations c
on s.user_id = c.user_id
GROUP BY s.user_id;


# Write your MySQL query statement below
select candidate_id from candidates
WHERE skill in ('Python', 'Tableau', 'PostgreSQL')
GROUP by candidate_id
HAVING count(skill) =3 ;

# Write your MySQL query statement below
SELECT p1.page_id
FROM pages p1
left JOIN page_likes p2
on p1.page_id = p2.page_id
Where p2.page_id is NULL
order by p1.page_id;

# Write your MySQL query statement below
select sum(case WHEN device_type = 'laptop' Then 1 else 0 END) as laptop_views,
sum(case when device_type IN('phone', 'tablet') then 1 else 0 END) as mobile_views
from viewership;

# Write your MySQL query statement below
SELECT user_id, MAX(post_date::DATE) - MIN(post_date::DATE) AS days_between
FROM posts
WHERE post_date BETWEEN '2021-01-01' AND '2021-12-31'
group by user_id
HAVING COUNT(user_id) > 2;


# Write your MySQL query statement below
SELECT sender_id, count(sender_id) as message_count
FROM messages
where sent_date between '2022-08-01' and '2022-08-31'
GROUP by sender_id
order by message_count DESC
LIMIT 2;

# Write your MySQL query statement below
SELECT  EXTRACT(MONTH from submit_date) as mth, product_id AS product, round(avg(stars),2) as avg_stars
FROM reviews
group by product_id, mth
order by mth, product_id;


# Write your MySQL query statement below
select e2.employee_id, e2.name as employee_name
from employee e1
left join employee e2
on e1.employee_id = e2.manager_id
where e2.salary > e1.salary
order by e2.manager_id;


# Write your MySQL query statement below
select * 
from Cinema
where id%2!=0
and description != 'boring'
order by rating DESC;


# Write your MySQL query statement below
select p.product_id  , ifnull(round(sum(p.price*u.units)/sum(u.units),2),0) as average_price
from Prices p
left Join UnitsSold u
on p.product_id=u.product_id
and u.purchase_date between p.start_date and p.end_date
group by  product_id


# Write your MySQL query statement below
select  contest_id, round(count(distinct user_id )*100/(select count(user_id) from Users),2) as percentage
from Register
group by contest_id
order by percentage DESC, contest_id ASC
